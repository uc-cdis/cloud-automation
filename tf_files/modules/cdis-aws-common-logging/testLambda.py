#!/usr/bin/env python3
import pytest
import lambda_function

example = {'Records': [{'kinesis': {'kinesisSchemaVersion': '1.0', 'partitionKey': '81a6fb0168975347bb8d9ed7cd945367', 'sequenceNumber': '49582863307409319741090962153614735877224301205609512962', 'data': 'H4sIAAAAAAAAAMWQS2vDMBCE/4rQKYEI9JZl6CG0aU5pocmthCDbaiqwJSPLaUPIf6/6gpBrD70tM8vMfnuCnR0Gs7ebY29hCe/mm/lutViv58sFnMHw5m3MssJKSUUkpoXKchv2yxjGPjuNPfSt8TYdyLexTtGaLjt5dn7nQ2ORGdMrcj0iiiLKkeSIY+QQrriWxkhdcWpqplhOGMZqqKPrkwv+3rXJxgGWz5c1u8sVuP0qXRysT5+LJ+ia3M2Y5owXimuNBSkkxVozpbngmHNBOKZUUVxoKRjXQjBNJcOq4PmA5PJHkukyHBGUZlVSgjGe/X4qx69MBFQCIkqmSkzAFRq4fXp8eFZS4m0JetPtRu/eJ3UMvhxyRj57WoKfCYTeetuAlxDBONgIYggJVEcwGV1zg6fwPPsbk/gHproNwzUTPG/PH2fPgL5uAgAA', 'approximateArrivalTimestamp': 1522078629.716}, 'eventSource': 'aws:kinesis', 'eventVersion': '1.0', 'eventID': 'shardId-000000000000:49582863307409319741090962153614735877224301205609512962', 'eventName': 'aws:kinesis:record', 'invokeIdentityArn': 'arn:aws:iam::433568766270:role/devplanetv1_lambda', 'awsRegion': 'us-east-1', 'eventSourceARN': 'arn:aws:kinesis:us-east-1:433568766270:stream/devplanetv1_stream'}, {'kinesis': {'kinesisSchemaVersion': '1.0', 'partitionKey': 'fa9401770aca21f01338db54f9519935', 'sequenceNumber': '49582863307409319741090962153615944803043915903503695874', 'data': 'H4sIAAAAAAAAAO1T22rcMBD9FeGnhEZeXWxJNrQQaJq+BArZt/WyyJYcu/GtljYlpPvvHXt3c+kNSl6DwUhz0ZyZOechaK1z+sYu7wcbpMHH8+X55uri+vr88iI4C/rvnR3BLImUQlJBmJJgbvqby7HfDuAx9m5odGf9Hd07rv1odQue221uR3BYF97pMQRXWPSd1zU86UJXWTuY/gYbOzT9fWs7j2lMZcRoIgVub3PzdeMr3VWd2TwG51HJbWRIkeeUW8YTZXlJtC210NoYXZKyFJLxXMmSc6KUyfMiibUS0sgijyYUANNtc1eM9eDrvvtUNx4ABenqeS+b5yHBeu7s4g5AToEPQW2gQc6TiEdKcBURGsFsqGQqUiwRiYiV4oRBP4oqyRX8uSJgFJGIAICvYexetzBBGjNGpIolJYScHdcBzz9kU9EsSLNgNdQmRUz90MOQIvJjtN/gCnUXksV8jSgJWSh5SNHJKXrgEYKBO1R3iCcc5fewgh1aXfUdutIjYgLROOUipRQxQtUaXV4s0WIDePzWofcf0I2FFWlvDZL77OmpCLXOFg6dfF4uvyxoOCWTU8RQZbWx+3JSHeJPKHLfa19UcIayRT9aRE6zrMuCsyxwM0XmzpyH3HG2mr64tXBMofFHomxqM8e9dvFZsIMST5T8tUynW7sHdKDaDGmyukEX9sl/oOTsHnrze+K/CP2YdeiK6EQXItaYmTjGlFqFtWAxJraQRJU0zo2acxqd2+YAGjjwO1ID65qtQCcqYsEIPxbD3rZAa29xpV11CDri2s+l6p2fHfWAgcSYRVgITAkLbcHCugOBdLqZH2y1g9tmOzZzQuX94NLFAhjIQxLSNIr4Qg/1L+M7bpHwpCw4wSAV/td+dzsA9TqNxf+vMYymb8XEAkSymISRPsrkHaSRNcqyLHihlaMUJsckB9DLdMTzfY7u8TQhXDQ18OEY+mcd9Fv/poM3HbzUwXr3E2dXYDuiBwAA', 'approximateArrivalTimestamp': 1522078630.322}, 'eventSource': 'aws:kinesis', 'eventVersion': '1.0', 'eventID': 'shardId-000000000000:49582863307409319741090962153615944803043915903503695874', 'eventName': 'aws:kinesis:record', 'invokeIdentityArn': 'arn:aws:iam::433568766270:role/devplanetv1_lambda', 'awsRegion': 'us-east-1', 'eventSourceARN': 'arn:aws:kinesis:us-east-1:433568766270:stream/devplanetv1_stream'}]}

def test_answer():
    assert lambda_function.handler(example,'') 

#== """[{'Data': '{"messageType": "DATA_MESSAGE", "owner": "707767160287", "logGroup": "devplanetv1", "logStream": "login_node-auth-ip-172-24-64-40-i-0b496aa69b42ac373", "subscriptionFilters": ["devplanetv1_subscription"], "timestamp": "2018-03-26T15:37:01", "message": {"log": "Mar 26 15:37:01 ip-172-24-64-40 CRON[7660]: pam_unix(cron:session): session opened for user root by (uid=0)"}}'}, {'Data': '{"messageType": "DATA_MESSAGE", "owner": "707767160287", "logGroup": "devplanetv1", "logStream": "login_node-auth-ip-172-24-64-40-i-0b496aa69b42ac373", "subscriptionFilters": ["devplanetv1_subscription"], "timestamp": "2018-03-26T15:37:01", "message": {"log": "Mar 26 15:37:01 ip-172-24-64-40 CRON[7660]: pam_unix(cron:session): session closed for user root"}}'}][{'Data': '{"messageType": "DATA_MESSAGE", "owner": "707767160287", "logGroup": "devplanetv1", "logStream": "kubernetes.var.log.containers.sheepdog-deployment-1517421976-mkbdj_thanhnd_sheepdog-b4f3e4d0cbb13e2398e3f0aefa6aaddaf0ff6723b87f33088dbbc95a867d7cb4.log", "subscriptionFilters": ["devplanetv1_subscription"], "timestamp": "2018-03-26T15:36:11", "message": {"log": "[pid: 28|app: 0|req: 2384/7253] 10.2.73.1 () {34 vars in 393 bytes} [Mon Mar 26 15:36:11 2018] GET /_status => generated 7 bytes in 4 msecs (HTTP/1.1 200) 2 headers in 78 bytes (1 switches on core 0)\\n", "stream": "stderr", "docker": {"container_id": "b4f3e4d0cbb13e2398e3f0aefa6aaddaf0ff6723b87f33088dbbc95a867d7cb4"}, "kubernetes": {"container_name": "sheepdog", "namespace_name": "thanhnd", "pod_name": "sheepdog-deployment-1517421976-mkbdj", "pod_id": "0a9ac65a-2d55-11e8-a625-0ec708f15bd8", "labels": {"app": "sheepdog", "date": "1521656203", "pod-template-hash": "1517421976"}, "host": "ip-172-24-66-102.ec2.internal", "master_url": "https://10.3.0.1:443/api", "namespace_id": "b039fc30-2173-11e8-a625-0ec708f15bd8"}}}'}, {'Data': '{"messageType": "DATA_MESSAGE", "owner": "707767160287", "logGroup": "devplanetv1", "logStream": "kubernetes.var.log.containers.sheepdog-deployment-1517421976-mkbdj_thanhnd_sheepdog-b4f3e4d0cbb13e2398e3f0aefa6aaddaf0ff6723b87f33088dbbc95a867d7cb4.log", "subscriptionFilters": ["devplanetv1_subscription"], "timestamp": "2018-03-26T15:36:11+00:00", "message": {"log": "- - - [26/Mar/2018:15:36:11 +0000] \\"GET /_status HTTP/1.1\\" 200 7 \\"-\\" \\"Go-http-client/1.1\\"\\n", "stream": "stdout", "docker": {"container_id": "b4f3e4d0cbb13e2398e3f0aefa6aaddaf0ff6723b87f33088dbbc95a867d7cb4"}, "kubernetes": {"container_name": "sheepdog", "namespace_name": "thanhnd", "pod_name": "sheepdog-deployment-1517421976-mkbdj", "pod_id": "0a9ac65a-2d55-11e8-a625-0ec708f15bd8", "labels": {"app": "sheepdog", "date": "1521656203", "pod-template-hash": "1517421976"}, "host": "ip-172-24-66-102.ec2.internal", "master_url": "https://10.3.0.1:443/api", "namespace_id": "b039fc30-2173-11e8-a625-0ec708f15bd8"}}}'}] """

#if __name__ == "__main__":
#    assert lambda_function.handler(example,'')
