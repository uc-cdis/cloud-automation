location /ohif-viewer/ {
    # if ($csrf_check !~ ^ok-\S.+$) {
    #   return 403 "failed csrf check";
    # }

    set $authz_resource "/services/ohif-viewer";
    set $authz_method "create";
    set $authz_service "ohif-viewer";

    if ($request_uri ~ "^/ohif-viewer/dicom-web/studies/") {
        set $authz_method "read";
        set $authz_resource "/services/ohif-viewer/studies";
    }

    auth_request /gen3-authz;

    proxy_set_header Authorization "Basic cHVibGljOmhlbGxv";

    set $proxy_service  "ohif-viewer";
    set $upstream http://ohif-viewer-service.$namespace.svc.cluster.local;
    rewrite ^/ohif-viewer/(.*) /$1 break;
    proxy_pass $upstream;
}
